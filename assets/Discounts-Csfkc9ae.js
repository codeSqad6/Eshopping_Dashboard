import{r as h,j as e,y as x,u as O}from"./index-CbH0sxRD.js";import{a as A}from"./index-Dq7h7Pqt.js";import{o as P,p as y,q as N,T as i,r as S,B as f}from"./DefaultLayout-D0LMmzSe.js";/* empty css                             */import"./Widgets-B08Rz-tg.js";const T=({open:g,onClose:u,onSave:D,initialData:n})=>{const[t,c]=h.useState({nameEn:"",nameAr:"",descriptionEn:"",descriptionAr:"",discountCode:"",discountPercentage:"",startDate:"",endDate:"",status:""});h.useEffect(()=>{n&&c({id:n.id||"",nameEn:n.nameEn||"",nameAr:n.nameAr||"",descriptionEn:n.description||"",descriptionAr:n.descriptionAr||"",discountCode:n.discountCode||"",discountPercentage:n.discountPercentage||"",startDate:n.startDate||"",endDate:n.endDate||"",status:n.isActive?"true":"false"})},[n]);const r=s=>{const{name:d,value:a,type:p,files:j}=s.target;c(p==="file"?m=>({...m,[d]:j[0]}):m=>({...m,[d]:a}))},C=async()=>{var s;if(t.nameEn)try{const d=sessionStorage.getItem("token"),a=new FormData;a.append("Name",t.nameEn),a.append("NameAr",t.nameAr),a.append("Description",t.descriptionEn||""),a.append("DescriptionAr",t.descriptionAr||""),a.append("DiscountCode",t.discountCode||""),a.append("DiscountPercentage",t.discountPercentage||""),a.append("StartDate",t.startDate||""),a.append("EndDate",t.endDate||""),a.append("IsActive",t.status);const p=await A.post("http://test.smartsto0re.shop/api/Discounts",a,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${d}`}});x.success("Discount added successfully!"),console.log(p.data),D(p.data),u()}catch(d){console.error("❌ Error Response:",((s=d.response)==null?void 0:s.data)||d.message),x.error("Failed to add Discount. Check required fields.")}else x.error("Please fill required fields")};return e.jsxs(P,{open:g,onClose:u,children:[e.jsx(y,{children:"Add New Discount"}),e.jsxs(N,{children:[e.jsx(i,{label:"Discount Name Arabic",name:"nameAr",fullWidth:!0,margin:"dense",value:t.nameAr,onChange:r}),e.jsx(i,{label:"Discount Name English",name:"nameEn",fullWidth:!0,margin:"dense",value:t.nameEn,onChange:r}),e.jsx(i,{label:"Description English",name:"descriptionEn",fullWidth:!0,margin:"dense",multiline:!0,rows:4,value:t.descriptionEn,onChange:r}),e.jsx(i,{label:"Description Arabic",name:"descriptionAr",fullWidth:!0,margin:"dense",multiline:!0,rows:4,value:t.descriptionAr,onChange:r}),e.jsx(i,{label:"Discount DiscountCode",name:"discountCode",fullWidth:!0,margin:"dense",value:t.discountCode,onChange:r}),e.jsx(i,{label:"Discount DiscountPercentage",name:"discountPercentage",type:"number",fullWidth:!0,margin:"dense",value:t.discountPercentage,onChange:r}),e.jsx(i,{label:"Discount Start Date",name:"startDate",type:"date",fullWidth:!0,margin:"dense",value:t.startDate,onChange:r,InputLabelProps:{shrink:!0}}),e.jsx(i,{label:"Discount End Date",name:"endDate",type:"date",fullWidth:!0,margin:"dense",value:t.endDate,onChange:r,InputLabelProps:{shrink:!0}}),e.jsxs(i,{select:!0,label:"Select status",name:"status",fullWidth:!0,margin:"normal",value:t.status,onChange:s=>{const d=s.target.value==="true";c(a=>({...a,status:d}))},SelectProps:{native:!0},children:[e.jsx("option",{value:"",children:"Select status"}),e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]})]}),e.jsxs(S,{children:[e.jsx(f,{onClick:u,children:"Cancel"}),e.jsx(f,{onClick:C,variant:"contained",children:"Add"})]})]})},$=({open:g,onClose:u,onSave:D,initialData:n})=>{const[t,c]=h.useState({nameEn:"",nameAr:"",descriptionEn:"",descriptionAr:"",discountCode:"",discountPercentage:"",startDate:"",endDate:"",status:"true"});h.useEffect(()=>{g&&n&&c({id:n.id,nameEn:n.name||"",nameAr:n.name||"",descriptionEn:n.description||"",descriptionAr:n.description||"",discountCode:n.discountCode||"",discountPercentage:n.discountPercentage||"",startDate:n.startDate?n.startDate.substring(0,10):"",endDate:n.endDate?n.endDate.substring(0,10):"",status:n.isActive?"true":"false"})},[g,n]);const r=s=>{const{name:d,value:a,type:p,files:j}=s.target;c(p==="file"?m=>({...m,image:j[0]}):m=>({...m,[d]:a}))},C=async()=>{if(!t.nameEn){x.error("Please fill required fields");return}try{const s=new FormData;s.append("Name",t.nameEn),s.append("NameAr",t.nameAr),s.append("Description",t.descriptionEn),s.append("DescriptionAr",t.descriptionAr),s.append("DiscountCode",t.discountCode||""),s.append("DiscountPercentage",t.discountPercentage||""),s.append("StartDate",t.startDate||""),s.append("EndDate",t.endDate||""),s.append("IsActive",t.status==="true");const d=sessionStorage.getItem("token"),a=await A.put(`http://test.smartsto0re.shop/api/Discounts/${t.id}`,s,{headers:{Authorization:`Bearer ${d}`,"Content-Type":"multipart/form-data"}});x.success("Discount updated successfully"),D==null||D(a.data),u()}catch(s){console.error(s),x.error("Failed to update Discount")}};return e.jsxs(P,{open:g,onClose:u,fullWidth:!0,maxWidth:"sm",children:[e.jsx(y,{children:"Edit Discount"}),e.jsxs(N,{children:[e.jsx(i,{label:"Discount Name Arabic",name:"nameAr",fullWidth:!0,margin:"dense",value:t.nameAr,onChange:r}),e.jsx(i,{label:"Discount Name English",name:"nameEn",fullWidth:!0,margin:"dense",value:t.nameEn,onChange:r}),e.jsx(i,{label:"Description English",name:"descriptionEn",fullWidth:!0,margin:"dense",multiline:!0,rows:4,value:t.descriptionEn,onChange:r}),e.jsx(i,{label:"Description Arabic",name:"descriptionAr",fullWidth:!0,margin:"dense",multiline:!0,rows:4,value:t.descriptionAr,onChange:r}),e.jsx(i,{label:"Discount DiscountCode",name:"discountCode",fullWidth:!0,margin:"dense",value:t.discountCode,onChange:r}),e.jsx(i,{label:"Discount DiscountPercentage",name:"discountPercentage",type:"number",fullWidth:!0,margin:"dense",value:t.discountPercentage,onChange:r}),e.jsx(i,{label:"Discount Start Date",name:"startDate",type:"date",fullWidth:!0,margin:"dense",value:t.startDate,onChange:r,InputLabelProps:{shrink:!0}}),e.jsx(i,{label:"Discount End Date",name:"endDate",type:"date",fullWidth:!0,margin:"dense",value:t.endDate,onChange:r,InputLabelProps:{shrink:!0}}),e.jsxs(i,{select:!0,label:"Select status",name:"status",fullWidth:!0,margin:"normal",value:t.status,onChange:r,SelectProps:{native:!0},children:[e.jsx("option",{value:"",children:"Select status"}),e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]})]}),e.jsxs(S,{children:[e.jsx(f,{onClick:u,children:"Cancel"}),e.jsx(f,{onClick:C,variant:"contained",children:"Save Changes"})]})]})},L=({open:g,onClose:u,onConfirm:D,Discount:n})=>{const t=async()=>{try{const c=sessionStorage.getItem("token"),r=await A.delete(`http://test.smartsto0re.shop/api/Discounts/${n.id}`,{headers:{Authorization:`Bearer ${c}`}});x.success("Discount deleted successfully"),D(n.id),u()}catch(c){console.error("❌ Error deleting Discount:",c),x.error("Failed to delete Discount")}};return e.jsxs(P,{open:g,onClose:u,className:"delete-dialog",children:[e.jsx(y,{children:"Confirm Deletion"}),e.jsxs(N,{children:["Are you sure you want to delete ",e.jsx("strong",{children:(n==null?void 0:n.name)||"this Discount"}),"?"]}),e.jsxs(S,{children:[e.jsx(f,{onClick:u,color:"inherit",children:"Cancel"}),e.jsx(f,{onClick:t,color:"error",variant:"contained",children:"Delete"})]})]})};function G(){O();const[g,u]=h.useState(!1),[D,n]=h.useState(!1),[t,c]=h.useState(!1),[r,C]=h.useState(null),[s,d]=h.useState(null),[a,p]=h.useState([]),[j,m]=h.useState(1),v=5,E=Math.ceil(a.length/v),k=j*v,I=k-v,W=a.slice(I,k);h.useEffect(()=>{(async()=>{try{const l=sessionStorage.getItem("token"),b=await A.get("http://test.smartsto0re.shop/api/Discounts",{headers:{Authorization:`Bearer ${l}`}});p(b.data)}catch(l){console.error("❌ Error fetching Discounts:",l),x.error("Failed to bring the Discounts.")}})()},[]);const w=o=>{p(l=>[...l,o])},B=o=>{p(a.map(l=>l.id===o.id?o:l))},F=o=>{p(l=>l.filter(b=>b.id!==o)),c(!1),C(null)};return console.log(W,"currentDiscounts"),e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",children:[e.jsx("p",{children:"Add a New Discounts"}),e.jsx(f,{variant:"contained",color:"primary",onClick:()=>u(!0),children:"Add Discount"})]}),e.jsxs("table",{className:"Discounts_table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"NameEn"}),e.jsx("th",{children:"Discount Code "}),e.jsx("th",{children:"Discount Percentage"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Edit"}),e.jsx("th",{children:"Delete"})]})}),e.jsx("tbody",{children:W.map(o=>e.jsxs("tr",{children:[e.jsx("td",{children:o.name}),e.jsx("td",{children:o.discountCode}),e.jsx("td",{children:o.discountPercentage}),e.jsx("td",{children:e.jsx("span",{className:o.isActive===!0?"active":"inactive",children:o.isActive?"Active":"Inactive"})}),e.jsx("td",{children:e.jsx("button",{className:"button editButton",onClick:()=>{d(o),n(!0)},children:e.jsx("i",{className:"fas fa-edit"})})}),e.jsx("td",{children:e.jsx("button",{className:"button deleteButton",onClick:()=>{C(o),c(!0)},children:e.jsx("i",{className:"fas fa-trash"})})})]},o.id))})]}),e.jsxs("div",{className:"pagination",children:[e.jsx("button",{className:"pageBtn",onClick:()=>m(o=>Math.max(o-1,1)),disabled:j===1,children:"<<"}),[...Array(E)].map((o,l)=>e.jsx("button",{className:`pageBtn ${j===l+1?"pageBtnActive":"pageBtnInactive"}`,onClick:()=>m(l+1),children:l+1},l)),e.jsx("button",{className:"pageBtn",onClick:()=>m(o=>Math.min(o+1,E)),disabled:j===E,children:">"})]}),e.jsx(T,{open:g,onClose:()=>u(!1),onSave:w}),e.jsx($,{open:D,onClose:()=>n(!1),onSave:B,initialData:s}),e.jsx(L,{open:t,className:"delete-dialog",onClose:()=>c(!1),onConfirm:F,Discount:r})]})}export{G as default};
